import{Q as u,C}from"./ClosePopup.d6afd339.js";import{_ as b,Q as y,R as _,S as o,T as l,U as s,X as m,aC as c,at as x,aD as Q,aB as p,V as a,W as V,aE as D,L as w,aF as v}from"./index.0201c8ba.js";import{Q as g,a as E}from"./QTable.a0d1b90c.js";import{Q as I}from"./QChip.2539c24b.js";import{Q as k}from"./QSpace.93af7937.js";import{Q as T}from"./QSelect.9a427e5e.js";import{Q as N}from"./QForm.133b75c3.js";import{Q as S}from"./QPage.23f53c4a.js";import"./format.6ac589cc.js";import"./QList.c138df6e.js";import"./QMarkupTable.beae6fce.js";const U={name:"ClientsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name},{name:"cinit",label:"C.I. o NIT",align:"left",field:e=>e.cinit},{name:"email",label:"Correo",align:"left",field:e=>e.email},{name:"type",label:"Tipo",align:"left",field:e=>e.type}],loading:!1,clients:[],client:{},clientDialog:!1,clienDialogHistory:!1,filter:""}},mounted(){this.getClients()},methods:{clientSave(){this.loading=!0,this.client.id?this.$axios.put(`clients/${this.client.id}`,this.client).then(e=>{this.clientDialog=!1;const n=this.clients.findIndex(d=>d.id===this.client.id);this.clients.splice(n,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("clients",this.client).then(e=>{this.clientDialog=!1,this.clients.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},clientDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este cliente?").onOk(()=>{this.loading=!0,this.$axios.delete(`clients/${e}`).then(n=>{const d=this.clients.findIndex(f=>f.id===e);this.clients.splice(d,1)}).catch(n=>{this.$alert.error(n.response.data.message)}).finally(()=>{this.loading=!1})})},clientHistory(e){this.clienDialogHistory=!0,this.client={...e}},clientEdit(e){this.clientDialog=!0,this.client={...e}},clientAdd(){this.clientDialog=!0,this.client={name:"",ci:""}},getClients(){this.loading=!0,this.$axios.get("clients").then(e=>{this.clients=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},A={class:"text-h6"},B={class:"row"},q={class:"col-12"},O={class:"col-12"},H={class:"col-12"},L={class:"col-12"};function P(e,n,d,f,t,r){return y(),_(S,{class:"bg-grey-3 q-pa-md"},{default:o(()=>[l(E,{rows:t.clients,columns:t.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading},{"body-cell-option":o(i=>[l(g,{"auto-width":""},{default:o(()=>[l(s,{flat:"",dense:"",icon:"edit",onClick:h=>r.clientEdit(i.row)},{default:o(()=>[l(u,null,{default:o(()=>[m("Editar")]),_:1})]),_:2},1032,["onClick"]),l(s,{flat:"",dense:"",icon:"delete",onClick:h=>r.clientDelete(i.row.id)},{default:o(()=>[l(u,null,{default:o(()=>[m("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"top-right":o(()=>[l(s,{outline:"",dense:"",icon:"add_circle",onClick:r.clientAdd,label:"Agregar","no-caps":"",loading:t.loading},{default:o(()=>[l(u,null,{default:o(()=>[m("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),l(c,{modelValue:t.filter,"onUpdate:modelValue":n[0]||(n[0]=i=>t.filter=i),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:o(()=>[l(x,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-type":o(i=>[l(g,{props:i},{default:o(()=>[l(I,{dense:"",label:i.row.type,color:i.row.type==="CLIENTE"?"green":"blue","text-color":"white"},null,8,["label","color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","loading"]),l(v,{modelValue:t.clientDialog,"onUpdate:modelValue":n[6]||(n[6]=i=>t.clientDialog=i),persistent:""},{default:o(()=>[l(Q,{style:{width:"250px","max-width":"90vw"}},{default:o(()=>[l(p,{class:"row items-center"},{default:o(()=>[a("div",A,V(t.client.id?"Editar":"Agregar")+" Cliente",1),l(k),l(s,{flat:"",dense:"",icon:"close",onClick:n[1]||(n[1]=i=>t.clientDialog=!1)})]),_:1}),l(N,{onSubmit:r.clientSave},{default:o(()=>[l(p,null,{default:o(()=>[a("div",B,[a("div",q,[l(c,{modelValue:t.client.cinit,"onUpdate:modelValue":n[2]||(n[2]=i=>t.client.cinit=i),dense:"",outlined:"",type:"text",label:"C.I. o NIT",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","rules"])]),a("div",O,[l(c,{modelValue:t.client.name,"onUpdate:modelValue":n[3]||(n[3]=i=>t.client.name=i),dense:"",outlined:"",type:"text",label:"Nombre",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","rules"])]),a("div",H,[l(T,{modelValue:t.client.type,"onUpdate:modelValue":n[4]||(n[4]=i=>t.client.type=i),dense:"",outlined:"",type:"text",label:"Tipo",rules:[i=>!!i||"Campo requerido"],options:["CLIENTE","PROVEEDOR"]},null,8,["modelValue","rules"])]),a("div",L,[l(c,{modelValue:t.client.email,"onUpdate:modelValue":n[5]||(n[5]=i=>t.client.email=i),dense:"",outlined:"",type:"text",label:"Correo"},null,8,["modelValue"])])])]),_:1}),l(D,{align:"right"},{default:o(()=>[w(l(s,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[C]]),l(s,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Z=b(U,[["render",P]]);export{Z as default};
