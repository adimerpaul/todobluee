import{a as b,d as y}from"./format.6ac589cc.js";import{Q as I}from"./QList.c138df6e.js";import{Q as D}from"./QBtnDropdown.459d36bd.js";import{Q as p,a as A}from"./QTable.a0d1b90c.js";import{Q as v,C as S}from"./ClosePopup.d6afd339.js";import{_ as U,Q as n,R as u,S as i,T as s,L as g,X as m,U as f,aC as k,at as E,W as x,a4 as T,b9 as N,V as d,aD as q,aB as C,ba as Q,aE as B,aF as H,a3 as V}from"./index.0201c8ba.js";import{Q as _}from"./QChip.2539c24b.js";import{Q as O}from"./QSpace.93af7937.js";import{Q as w}from"./QSelect.9a427e5e.js";import{Q as R}from"./QForm.133b75c3.js";import{Q as z}from"./QPage.23f53c4a.js";import"./QMarkupTable.beae6fce.js";const G={name:"SuppliesIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:o=>o.option},{name:"id",label:"ID",align:"left",field:o=>o.id},{name:"name",label:"Nombre",align:"left",field:o=>o.name},{name:"category_insumo",label:"Categoria",align:"left",field:o=>{var l;return(l=o.category_insumo)==null?void 0:l.name}},{name:"stock",label:"Stock",align:"left",field:o=>o.stock},{name:"unit",label:"Unidad",align:"left",field:o=>o.unit},{name:"status",label:"Estado",align:"left",field:o=>o.status}],loading:!1,insumos:[],insumo:{},insumoDialog:!1,clienDialogHistory:!1,filter:"",category_insumos:[]}},mounted(){this.getInsumos(),this.$axios.get("category_insumos").then(o=>{this.category_insumos=o.data}).catch(o=>{this.$alert.error(o.response.data.message)})},methods:{insumoStockUpdate(o){this.$axios.put(`insumosStock/${o.id}`,o).then(l=>{const c=this.insumos.findIndex(h=>h.id===l.data.id);this.insumos.splice(c,1,l.data)}).catch(l=>{this.$alert.error(l.response.data.message)})},insumoSave(){this.loading=!0,this.insumo.id?this.$axios.put(`insumos/${this.insumo.id}`,this.insumo).then(o=>{this.insumoDialog=!1;const l=this.insumos.findIndex(c=>c.id===this.insumo.id);this.insumos.splice(l,1,o.data)}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("insumos",this.insumo).then(o=>{this.insumoDialog=!1,this.insumos.unshift(o.data)}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})},insumoDelete(o){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este insumoe?").onOk(()=>{this.loading=!0,this.$axios.delete(`insumos/${o}`).then(l=>{const c=this.insumos.findIndex(h=>h.id===o);this.insumos.splice(c,1)}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})})},insumoHistory(o){this.clienDialogHistory=!0,this.insumo={...o}},insumoEdit(o){this.insumoDialog=!0,this.insumo={...o}},insumoAdd(){this.insumoDialog=!0,this.insumo={name:"",category_insumo_id:"",stock:"",unit:"",status:"ACTIVE"}},getInsumos(){this.loading=!0,this.$axios.get("insumos").then(o=>{this.insumos=o.data}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})}}},M=["onUpdate:modelValue","onChange"],F={class:"text-h6"},L={class:"row"},P={class:"col-12"},W={class:"col-12"},X={class:"col-12"},j={class:"col-12"},J={class:"col-12"};function K(o,l,c,h,t,r){return n(),u(z,{class:"bg-grey-3 q-pa-md"},{default:i(()=>[s(A,{rows:t.insumos,columns:t.columns,title:"Insumos","rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading},{"body-cell-option":i(e=>[s(p,{"auto-width":""},{default:i(()=>[s(D,{label:"Opciones",dense:"","no-caps":"",color:"primary",size:"10px"},{default:i(()=>[s(I,null,{default:i(()=>[g((n(),u(b,{clickable:"",onClick:a=>r.insumoEdit(e.row)},{default:i(()=>[s(y,null,{default:i(()=>[m("Editar")]),_:1})]),_:2},1032,["onClick"])),[[V]]),g((n(),u(b,{clickable:"",onClick:a=>r.insumoDelete(e.row.id)},{default:i(()=>[s(y,null,{default:i(()=>[m("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[V]]),g((n(),u(b,{clickable:"",onClick:a=>r.insumoHistory(e.row)},{default:i(()=>[s(y,null,{default:i(()=>[m("Historial")]),_:1})]),_:2},1032,["onClick"])),[[V]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"top-right":i(()=>[s(f,{outline:"",dense:"",icon:"add_circle",onClick:r.insumoAdd,label:"Agregar","no-caps":"",loading:t.loading},{default:i(()=>[s(v,null,{default:i(()=>[m("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),s(f,{outline:"",dense:"",icon:"refresh",onClick:r.getInsumos,label:"Actualizar","no-caps":"",loading:t.loading,class:"q-ml-md"},{default:i(()=>[s(v,null,{default:i(()=>[m("Actualizar")]),_:1})]),_:1},8,["onClick","loading"]),s(k,{modelValue:t.filter,"onUpdate:modelValue":l[0]||(l[0]=e=>t.filter=e),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:i(()=>[s(E,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-category_insumo":i(e=>[s(p,{props:e,class:"text-bold"},{default:i(()=>{var a;return[m(x((a=e.row.category_insumo)==null?void 0:a.name),1)]}),_:2},1032,["props"])]),"body-cell-status":i(e=>[s(p,{props:e,class:"text-bold"},{default:i(()=>[e.row.status==="ACTIVE"?(n(),u(_,{key:0,color:"positive",dense:"","text-color":"white",label:"Activo"})):(n(),u(_,{key:1,color:"negative",dense:"","text-color":"white",label:"Inactivo"}))]),_:2},1032,["props"])]),"body-cell-unit":i(e=>[s(p,{props:e,class:"text-bold"},{default:i(()=>[e.row.unit==="UNIDAD"?(n(),u(_,{key:0,color:"indigo",dense:"","text-color":"white",label:"UNIDAD"})):(n(),u(_,{key:1,color:"purple",dense:"","text-color":"white",label:"GRAMOS"}))]),_:2},1032,["props"])]),"body-cell-stock":i(e=>[s(p,{props:e,class:T(["text-bold",`text-${e.row.stock<300?"negative":"positive"}`])},{default:i(()=>[g(d("input",{"onUpdate:modelValue":a=>e.row.stock=a,type:"number",class:"q-pa-xs",style:{width:"100px"},onChange:a=>r.insumoStockUpdate(e.row)},null,40,M),[[N,e.row.stock]]),m(" "+x(e.row.stock),1)]),_:2},1032,["props","class"])]),_:1},8,["rows","columns","filter","loading"]),s(H,{modelValue:t.insumoDialog,"onUpdate:modelValue":l[8]||(l[8]=e=>t.insumoDialog=e),persistent:""},{default:i(()=>[s(q,{style:{width:"250px","max-width":"90vw"}},{default:i(()=>[s(C,{class:"row items-center"},{default:i(()=>[d("div",F,x(t.insumo.id?"Editar":"Agregar")+" Insumo",1),s(O),s(f,{flat:"",dense:"",icon:"close",onClick:l[1]||(l[1]=e=>t.insumoDialog=!1)})]),_:1}),s(R,{onSubmit:r.insumoSave},{default:i(()=>[s(C,null,{default:i(()=>[d("div",L,[d("div",P,[s(k,{modelValue:t.insumo.name,"onUpdate:modelValue":l[2]||(l[2]=e=>t.insumo.name=e),dense:"",outlined:"",type:"text",label:"Nombre",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",W,[s(w,{modelValue:t.insumo.category_insumo_id,"onUpdate:modelValue":l[3]||(l[3]=e=>t.insumo.category_insumo_id=e),dense:"",outlined:"",label:"Categoria",options:t.category_insumos,rules:[e=>!!e||"Campo requerido"],"map-options":"","emit-value":"","option-value":"id","option-label":"name"},null,8,["modelValue","options","rules"])]),d("div",X,[s(k,{modelValue:t.insumo.stock,"onUpdate:modelValue":l[4]||(l[4]=e=>t.insumo.stock=e),dense:"",outlined:"",type:"number",label:"Stock",hint:""},null,8,["modelValue"])]),d("div",j,[s(w,{modelValue:t.insumo.unit,"onUpdate:modelValue":l[5]||(l[5]=e=>t.insumo.unit=e),dense:"",outlined:"",type:"text",label:"Unidad",rules:[e=>!!e||"Campo requerido"],options:["UNIDAD","GRAMOS"]},null,8,["modelValue","rules"])]),d("div",J,[s(Q,{modelValue:t.insumo.status,"onUpdate:modelValue":l[6]||(l[6]=e=>t.insumo.status=e),color:"positive",val:"ACTIVE",label:"Activo"},null,8,["modelValue"]),s(Q,{modelValue:t.insumo.status,"onUpdate:modelValue":l[7]||(l[7]=e=>t.insumo.status=e),color:"negative",val:"INACTIVE",label:"Inactivo"},null,8,["modelValue"])])])]),_:1}),s(B,{align:"right"},{default:i(()=>[g(s(f,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[S]]),s(f,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var de=U(G,[["render",K]]);export{de as default};
