import{c as $,a as V,h as z,d as S,_ as I,Q as d,R as m,S as t,T as e,aB as p,V as a,aC as b,X as n,W as c,aD as y,U as h,a0 as D,a1 as A,a2 as T,at as v}from"./index.0201c8ba.js";import{a as U,b as f,Q as _}from"./QTable.a0d1b90c.js";import{Q as x}from"./QChip.2539c24b.js";import{Q as C}from"./QSpace.93af7937.js";import{a as q,d as w,e as k}from"./format.6ac589cc.js";import{Q as B}from"./QList.c138df6e.js";import{Q as E}from"./QPage.23f53c4a.js";import"./QMarkupTable.beae6fce.js";import"./QSelect.9a427e5e.js";var Q=$({name:"QTr",props:{props:Object,noHover:Boolean},setup(l,{slots:o}){const u=V(()=>"q-tr"+(l.props===void 0||l.props.header===!0?"":" "+l.props.__trClass)+(l.noHover===!0?" q-tr--no-hover":""));return()=>z("tr",{class:u.value},S(o.default))}});const N={data(){return{search:"",insumos:[],categories:[],insumosAll:[],client:{ci:"",name:""},recibido:"",saleDialog:!1,loading:!1,columns:[{name:"name",label:"Nombre",align:"left",field:"name"},{name:"unit",label:"Unidad",align:"left",field:"unit"},{name:"status",label:"Estado",align:"left",field:"status"},{name:"stock",label:"Stock",align:"right",field:"stock"}]}},created(){this.insumosGet()},methods:{deregistration(){if(this.$store.buys.length===0)return this.$alert.error("Debe agregar productos al carrito"),!1;this.$alert.confirm("\xBFDesea realizar el egreso?").onOk(()=>{this.loading=!0,this.$axios.post("deregistrations",{insumos:this.$store.buys}).then(l=>{this.$store.buys=[],this.$alert.success("Egreso realizado"),this.insumosGet()}).catch(l=>{this.$alert.error("Error al realizar el egreso")}).finally(()=>{this.loading=!1})})},pay(){if(this.$store.buys.length===0)return this.$alert.error("Debe agregar productos al carrito"),!1;this.$alert.confirm("\xBFDesea realizar la compra?").onOk(()=>{this.loading=!0,this.$axios.post("purchases",{insumos:this.$store.buys}).then(l=>{this.$store.buys=[],this.$alert.success("Compra realizada"),this.insumosGet()}).catch(l=>{this.$alert.error("Error al realizar la compra")}).finally(()=>{this.loading=!1})})},categoryClick(l){l.id===""?this.insumos=this.insumosAll:this.insumos=this.insumosAll.filter(o=>o.category_id===l.id)},productClick(l){const o=this.$store.buys.find(u=>u.id===l.id);o?o.cantidadSale+=1:this.$store.buys.push({id:l.id,name:l.name,price:0,cantidadSale:1})},insumosGet(){this.loading=!0,this.$axios.get("listInsumo").then(l=>{this.insumos=l.data,this.insumosAll=l.data}).finally(()=>{this.loading=!1})}}},G={class:"row"},O={class:"col-12 col-md-8"},L={class:"row"},F={class:"col-12 col-md-4"},P=a("div",{class:"col-12 col-md-2"},null,-1),H=a("div",{class:"col-12 col-md-6 text-right"},null,-1),R={class:"col-12"},j={class:"col-12 col-md-4"},M=a("div",{class:"text-subtitle1 text-bold text-white"}," Compras ",-1),W={class:"row"},X={class:"col-12"},J={class:"row"},K={class:"col-6"},Y={class:"col-6"},Z={class:"col-12"},ee=a("div",{class:"text-bold text-black"}," Total ",-1),se={class:"text-bold text-h5 text-red"},te={class:"col-12 q-pa-xs"},le={class:"col-12 q-pa-xs"};function ae(l,o,u,oe,i,g){return d(),m(E,{class:"bg-grey-3 q-pa-xs"},{default:t(()=>[e(y,null,{default:t(()=>[e(p,{class:"q-pa-xs"},{default:t(()=>[a("div",G,[a("div",O,[a("div",L,[a("div",F,[e(b,{modelValue:i.search,"onUpdate:modelValue":o[0]||(o[0]=s=>i.search=s),label:"Buscar",outlined:"",dense:"",clearable:"",loading:i.loading},null,8,["modelValue","loading"])]),P,H,a("div",R,[e(U,{rows:i.insumos,loading:i.loading,columns:i.columns,filter:i.search,dense:"","rows-per-page-options":[0]},{header:t(s=>[e(Q,{props:s,class:"bg-black text-white"},{default:t(()=>[e(f,{key:"name",props:s},{default:t(()=>[n(" Nombre ")]),_:2},1032,["props"]),e(f,{key:"unit",props:s},{default:t(()=>[n(" Unidad ")]),_:2},1032,["props"]),e(f,{key:"status",props:s},{default:t(()=>[n(" Estado ")]),_:2},1032,["props"]),e(f,{key:"stock",props:s},{default:t(()=>[n(" Stock ")]),_:2},1032,["props"])]),_:2},1032,["props"])]),body:t(s=>[e(Q,{props:s,onClick:r=>g.productClick(s.row)},{default:t(()=>[e(_,{key:"name",props:s},{default:t(()=>[n(c(s.row.name),1)]),_:2},1032,["props"]),e(_,{key:"unit",props:s},{default:t(()=>[s.row.unit==="UNIDAD"?(d(),m(x,{key:0,color:"indigo",dense:"","text-color":"white",size:"10px",label:"UNIDAD"})):(d(),m(x,{key:1,color:"purple",dense:"","text-color":"white",size:"10px",label:"GRAMOS"}))]),_:2},1032,["props"]),e(_,{key:"status",props:s},{default:t(()=>[e(x,{label:s.row.status==="ACTIVE"?"Activo":"Inactivo",color:s.row.status==="ACTIVE"?"green":"red",dense:"",size:"10px","text-color":"white"},null,8,["label","color"])]),_:2},1032,["props"]),e(_,{key:"stock",props:s},{default:t(()=>[n(c(s.row.stock),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","loading","columns","filter"])])])]),a("div",j,[e(y,null,{default:t(()=>[e(p,{class:"q-pa-xs row items-center bg-orange"},{default:t(()=>[M,e(C),e(h,{color:"red",label:"Limpiar",dense:"","no-caps":"",class:"text-bold",size:"10px",icon:"o_delete",onClick:o[1]||(o[1]=s=>l.$store.buys=[]),loading:i.loading},null,8,["loading"])]),_:1}),e(p,{class:"q-pa-xs"},{default:t(()=>[a("div",W,[a("div",X,[e(B,{bordered:"",dense:""},{default:t(()=>[(d(!0),D(T,null,A(l.$store.buys,s=>(d(),m(q,{key:s.id},{default:t(()=>[e(w,null,{default:t(()=>[e(k,{class:"text-bold"},{default:t(()=>[n(c(s.name),1)]),_:2},1024),e(k,{caption:""},{default:t(()=>[a("div",J,[a("div",K,[e(b,{modelValue:s.price,"onUpdate:modelValue":r=>s.price=r,dense:"",outlined:"",type:"number",step:"0.01"},{prepend:t(()=>[e(v,{name:"fa-solid fa-dollar-sign",size:"10px"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),a("div",Y,[e(b,{modelValue:s.cantidadSale,"onUpdate:modelValue":r=>s.cantidadSale=r,dense:"",outlined:"",type:"number"},{prepend:t(()=>[e(v,{name:"fa-solid fa-shopping-cart",size:"10px"})]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024),e(w,{class:"text-right",side:""},{default:t(()=>[e(k,{class:"text-red text-bold text-h6"},{default:t(()=>[n(c((s.price*s.cantidadSale).toFixed(2))+" ",1),e(h,{dense:"",flat:"",rounded:"",icon:"delete",size:"10px",color:"red",onClick:r=>l.$store.buys.splice(l.$store.buys.indexOf(s),1)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),a("div",Z,[e(p,{class:"q-pa-xs row items-center"},{default:t(()=>[ee,e(C),a("div",se,c(l.$store.buys.reduce((s,r)=>s+r.price*r.cantidadSale,0).toFixed(2))+" Bs ",1)]),_:1})]),a("div",te,[e(h,{color:"green",label:"Comprar",dense:"","no-caps":"",class:"full-width text-bold",size:"lg",icon:"shopping_cart",onClick:g.pay,loading:i.loading},null,8,["onClick","loading"])]),a("div",le,[e(h,{color:"red",label:"Egreso",dense:"","no-caps":"",class:"full-width text-bold",size:"lg",icon:"shopping_cart",onClick:g.deregistration,loading:i.loading},null,8,["onClick","loading"])])])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})}var fe=I(N,[["render",ae]]);export{fe as default};
