import{_ as S,P as U,Q as n,R as c,S as i,T as t,aB as m,V as s,aC as u,U as d,a0 as g,a2 as A,a1 as O,aD as _,aE as y,aF as V,X as C,W as h,L as k,at as E,a3 as D,Z as p}from"./index.0fe33fcb.js";import{a as Q,d as f}from"./format.3e05a736.js";import{Q as N}from"./QBtnDropdown.5888ca50.js";import{Q as b}from"./QChip.84d6d42b.js";import{Q as q}from"./QMarkupTable.0761102d.js";import{Q as j}from"./QSpace.38c0a469.js";import{Q as B}from"./QSelect.d2147d0b.js";import{Q as I}from"./QForm.365fb91a.js";import{Q as P}from"./QPage.042eac51.js";import{h as G}from"./moment.40bc58bf.js";import{C as R}from"./Card2Component.f637de6a.js";import"./index.aa4d44c1.js";import{I as w}from"./Imprimir.fe92267a.js";import"./QList.e110f46f.js";const Y={name:"IndexPage",components:{Card2Component:R},data(){return{loading:!1,caja:[],dialogCaja:!1,fechaInicio:G().format("YYYY-MM-DD"),fechaFin:G().format("YYYY-MM-DD"),sales:[],ganancia1:{},ganancia2:{},ganancia3:{},ganancia4:{},egresoDialog:!1,egreso:{},provedores:[],chica:{},detalleGasto:[],cajaChica:{monto:0}}},mounted(){this.salesGet(),this.provedoresGet()},methods:{cajaPost(){this.loading=!0,this.$axios.post("/caja",this.chica).then(l=>{this.$alert.success("Caja  registrado"),this.dialogCaja=!1}).catch(l=>{console.error(l),this.$alert.error("Error al registrar")}).finally(()=>{this.loading=!1})},cajaClick(){this.dialogCaja=!0,this.chica={}},getCaja(){this.loading=!0,this.$axios.post("/totalCaja",{ini:this.fechaInicio,fin:this.fechaFin}).then(l=>{this.caja=l.data}).catch(l=>{console.error(l),this.$alert.error("Error Caja")}).finally(()=>{this.loading=!1})},egresoPost(){this.loading=!0,this.$axios.post("/egresos",this.egreso).then(l=>{this.$alert.success("Egreso registrado"),w.recibo(l.data),this.egresoDialog=!1}).catch(l=>{console.error(l),this.$alert.error("Error al registrar el egreso")}).finally(()=>{this.loading=!1})},provedoresGet(){this.$axios.get("/provedores").then(l=>{this.provedores=l.data}).catch(l=>{console.error(l)})},egreseClick(){this.egresoDialog=!0,this.egreso={total:"",provedor_id:"",descripcion:""}},reimprimir(l){w.recibo(l)},anular(l){this.$alert.confirm("\xBFEst\xE1 seguro de anular la venta?").onOk(()=>{this.$axios.post("saleAnular",{id:l.id}).then(o=>{this.$alert.success("Venta anulada"),this.salesGet()}).catch(o=>{console.error(o),this.$alert.error("Error al anular la venta")})})},salesGet(){this.loading=!0,this.$axios.get("/sales",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(l=>{this.detalleGasto=[],this.sales=l.data,this.sales.forEach(o=>{o.type==="EGRESO"&&o.status!=="ANULADO"&&this.detalleGasto.push(o)}),this.gananciaGet()}).catch(l=>{console.error(l)}).finally(()=>{this.loading=!1})},gananciaGet(){this.loading=!0,this.$axios.post("/reportGanancia",{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}).then(l=>{console.log(l.data),this.ganancia1=l.data[0],this.ganancia2=l.data[1],this.ganancia3=l.data[2],this.ganancia4=l.data[3]}).catch(l=>{console.error(l)}).finally(()=>{this.loading=!1})}},computed:{ingresos(){let l=0;return this.sales.forEach(o=>{o.type==="INGRESO"&&o.status!=="ANULADO"&&(l+=o.total)}),l},egresos(){let l=0;return this.sales.forEach(o=>{o.type==="EGRESO"&&o.status!=="ANULADO"&&(l+=o.total)}),l},totalCaja(){let l=0;return this.caja.forEach(o=>{l=l+parseFloat(o.monto)}),l},totalGasto(){return this.totalCaja-this.egresos}}},L={class:"row"},M={class:"col-12 col-md-2"},T={class:"col-12 col-md-2"},z={class:"col-12 col-md-2 text-center"},H={class:"col-12 col-md-6 text-right"},W={class:"col-12 col-md-4 q-pa-xs"},X={class:"col-12 col-md-4 q-pa-xs"},Z={class:"row"},J={class:"col-12"},K=s("thead",{class:"bg-black text-white"},[s("tr",null,[s("th",null,"Opciones"),s("th",null,"Fecha"),s("th",null,"Tipo"),s("th",null,"Descripcion"),s("th",null,"Name"),s("th",null,"Total"),s("th",null,"Usuario")])],-1),$={key:0},ee={class:"text-caption",style:{"max-width":"400px","white-space":"normal","overflow-wrap":"break-word","line-height":"0.9"}},oe={class:"text-bold"},le={key:1},te=s("tr",null,[s("td",{colspan:"7",class:"text-center"},"No hay ventas")],-1),ae=[te],se=s("div",{class:"text-h6"},"Egreso",-1),ie=s("div",{class:"text-h6"},"Ingreso Caja Chica Dia",-1),ne=s("div",{id:"myelement",class:"hidden"},null,-1);function re(l,o,de,ce,a,r){const v=U("card2-component");return n(),c(P,{class:"q-pa-md bg-grey-3"},{default:i(()=>[t(_,null,{default:i(()=>[t(m,{class:"q-pa-xs"},{default:i(()=>[s("div",L,[s("div",M,[t(u,{modelValue:a.fechaInicio,"onUpdate:modelValue":o[0]||(o[0]=e=>a.fechaInicio=e),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),s("div",T,[t(u,{modelValue:a.fechaFin,"onUpdate:modelValue":o[1]||(o[1]=e=>a.fechaFin=e),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),s("div",z,[t(d,{label:"Buscar",color:"indigo",onClick:r.salesGet,loading:a.loading,"no-caps":"",icon:"search",class:"text-bold"},null,8,["onClick","loading"])]),s("div",H,[t(d,{label:"Egreso",color:"red",onClick:r.egreseClick,loading:a.loading,"no-caps":"",icon:"add_circle_outline",class:"text-bold"},null,8,["onClick","loading"])]),s("div",W,[t(v,{title:"Ingresos",subtitle:r.ingresos+" Bs.",icon:"trending_up",color:"green"},null,8,["subtitle"])]),s("div",X,[t(v,{title:"Egresos",subtitle:r.egresos+" Bs.",icon:"trending_down",color:"red"},null,8,["subtitle"])])]),s("div",Z,[s("div",J,[t(q,{dense:"","wrap-cells":""},{default:i(()=>[K,a.sales.length>0?(n(),g("tbody",$,[(n(!0),g(A,null,O(a.sales,e=>{var x;return n(),g("tr",{key:e.id},[s("td",null,[C(h(e.numero)+" ",1),e.status!=="ANULADO"?(n(),c(N,{key:0,label:"Opciones","no-caps":"",size:"10px",dense:"",color:e.type==="EGRESO"?"red":"green","auto-close":""},{default:i(()=>[k((n(),c(Q,{clickable:"",onClick:F=>r.reimprimir(e)},{default:i(()=>[t(f,{avatar:""},{default:i(()=>[t(E,{name:"print"})]),_:1}),t(f,null,{default:i(()=>[C("Reimprimir")]),_:1})]),_:2},1032,["onClick"])),[[D]]),k((n(),c(Q,{clickable:"",onClick:F=>r.anular(e)},{default:i(()=>[t(f,{avatar:""},{default:i(()=>[t(E,{name:"cancel"})]),_:1}),t(f,null,{default:i(()=>[C("Anular")]),_:1})]),_:2},1032,["onClick"])),[[D]])]),_:2},1032,["color"])):p("",!0),e.status==="ANULADO"?(n(),c(b,{key:1,color:"red","text-color":"white",label:"Anulado",size:"12px",dense:""})):p("",!0)]),s("td",null,h(l.$filters.formatdMYHi(e.date+" "+e.time)),1),s("td",null,[e.type==="INGRESO"?(n(),c(b,{key:0,color:"green","text-color":"white",label:"Ingreso",size:"12px",dense:""})):p("",!0),e.type==="EGRESO"?(n(),c(b,{key:1,color:"red","text-color":"white",label:"Egreso",size:"12px",dense:""})):p("",!0)]),s("td",null,[s("div",ee,h(e.descripcion),1)]),s("td",null,h(e.name),1),s("td",oe,h(e.total)+" Bs",1),s("td",null,h((x=e.user)==null?void 0:x.name),1)])}),128))])):(n(),g("tbody",le,ae))]),_:1})])])]),_:1})]),_:1}),t(V,{modelValue:a.egresoDialog,"onUpdate:modelValue":o[7]||(o[7]=e=>a.egresoDialog=e),persistent:""},{default:i(()=>[t(_,null,{default:i(()=>[t(m,{class:"row items-center q-pb-none"},{default:i(()=>[se,t(j),t(d,{flat:"",round:"",dense:"",icon:"close",onClick:o[2]||(o[2]=e=>a.egresoDialog=!1)})]),_:1}),t(m,null,{default:i(()=>[t(I,{onSubmit:r.egresoPost},{default:i(()=>[t(u,{modelValue:a.egreso.total,"onUpdate:modelValue":o[3]||(o[3]=e=>a.egreso.total=e),label:"Total",type:"number",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"],step:"0.01"},null,8,["modelValue","rules"]),t(B,{modelValue:a.egreso.provedor_id,"onUpdate:modelValue":o[4]||(o[4]=e=>a.egreso.provedor_id=e),label:"Provedor",outlined:"",dense:"",options:a.provedores,"option-value":"id","option-label":"name",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","options","rules"]),t(u,{modelValue:a.egreso.descripcion,"onUpdate:modelValue":o[5]||(o[5]=e=>a.egreso.descripcion=e),label:"Descripcion",type:"text",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),t(y,{align:"right"},{default:i(()=>[t(d,{label:"Cancelar",color:"red",onClick:o[6]||(o[6]=e=>a.egresoDialog=!1),"no-caps":"",icon:"close",loading:a.loading},null,8,["loading"]),t(d,{label:"Guardar",color:"green",type:"submit","no-caps":"",icon:"save",loading:a.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(V,{modelValue:a.dialogCaja,"onUpdate:modelValue":o[12]||(o[12]=e=>a.dialogCaja=e),persistent:""},{default:i(()=>[t(_,null,{default:i(()=>[t(m,{class:"row items-center q-pb-none"},{default:i(()=>[ie,t(j),t(d,{flat:"",round:"",dense:"",icon:"close",onClick:o[8]||(o[8]=e=>a.dialogCaja=!1)})]),_:1}),t(m,null,{default:i(()=>[t(I,{onSubmit:r.cajaPost},{default:i(()=>[t(u,{modelValue:a.chica.monto,"onUpdate:modelValue":o[9]||(o[9]=e=>a.chica.monto=e),label:"Monto",type:"number",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"],step:"0.01"},null,8,["modelValue","rules"]),t(u,{modelValue:a.chica.descripcion,"onUpdate:modelValue":o[10]||(o[10]=e=>a.chica.descripcion=e),label:"Descripcion",type:"text",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),t(y,{align:"right"},{default:i(()=>[t(d,{label:"Cancelar",color:"red",onClick:o[11]||(o[11]=e=>a.dialogCaja=!1),"no-caps":"",icon:"close",loading:a.loading},null,8,["loading"]),t(d,{label:"Guardar",color:"green",type:"submit","no-caps":"",icon:"save",loading:a.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),ne]),_:1})}var Ee=S(Y,[["render",re]]);export{Ee as default};
